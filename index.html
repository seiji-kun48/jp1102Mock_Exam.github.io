<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>แบบฝึกหัดภาษาญี่ปุ่น Minna 13-25</title>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel (for JSX) -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@400;500;700&display=swap" rel="stylesheet">

    <style>
        body { font-family: 'Sarabun', sans-serif; }
    </style>
</head>
<body class="bg-gray-50">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // Icons Components (Inline SVGs to avoid dependency issues)
        const Icons = {
            Check: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polyline points="20 6 9 17 4 12"></polyline></svg>,
            Eye: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path><circle cx="12" cy="12" r="3"></circle></svg>,
            EyeOff: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"></path><line x1="1" y1="1" x2="23" y2="23"></line></svg>,
            BookOpen: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"></path><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"></path></svg>,
            Menu: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg>,
            X: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>,
            ArrowUp: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="12" y1="19" x2="12" y2="5"></line><polyline points="5 12 12 5 19 12"></polyline></svg>
        };

        const JapaneseExam = () => {
            const [activePart, setActivePart] = useState('part1');
            const [showMenu, setShowMenu] = useState(false);

            const examData = {
                part1: {
                title: "Part 1: จงเติมคำช่วยให้ถูกต้อง",
                instruction: "เติมคำช่วยลงในช่องว่าง (45 คะแนน)",
                type: "fill-in",
                questions: [
                    { q: "あれ（　）佐藤さん（　）くれたワインです。", a: "あれ（は）佐藤さん（が）くれたワインです。" },
                    { q: "時間（　）あったら、京都（　）旅行したいです。", a: "時間（が）あったら、京都（へ/に）旅行したいです。" },
                    { q: "父は私（　）時計（　）買ってくれました。", a: "父は私（に）時計（を）買ってくれました。" },
                    { q: "私（　）山田さん（　）傘（　）貸してあげました。", a: "私（は）山田さん（に）傘（を）貸してあげました。" },
                    { q: "日曜日（　）暇（　）とき、掃除（　）洗濯をします。", a: "日曜日（の）暇（な）とき、掃除（や）洗濯をします。" },
                    { q: "図書館（　）借りた本（　）なくしました。", a: "図書館（で）借りた本（を）なくしました。" },
                    { q: "信号（　）右（　）曲がる（　）、郵便局があります。", a: "信号（を）右（へ/に）曲がる（と）、郵便局があります。" },
                    { q: "このボタン（　）押す（　）、お釣りが出ます。", a: "このボタン（を）押す（と）、お釣りが出ます。" },
                    { q: "彼（　）日本語（　）話すこと（　）できます。", a: "彼（は）日本語（を）話すこと（が）できます。" },
                    { q: "明日、パーティー（　）行く（　）思います。", a: "明日、パーティー（へ）行く（と）思います。" },
                    { q: "ミラーさん（　）明日、来る（　）言いました。", a: "ミラーさん（は）明日、来る（と）言いました。" },
                    { q: "私（　）友達（　）引越し（　）手伝ってもらいました。", a: "私（は）友達（に）引越し（を）手伝ってもらいました。" },
                    { q: "誰（　）手伝ってくれなくて（　）、一人（　）やります。", a: "誰（も）手伝ってくれなくて（も）、一人（で）やります。" },
                    { q: "日本（　）物価（　）高い（　）思います。", a: "日本（の）物価（は）高い（と）思います。" },
                    { q: "橋（　）渡って、公園（　）散歩します。", a: "橋（を）渡って、公園（を）散歩します。" },
                    { q: "図書館（　）行くとき、地図（　）持って行きます。", a: "図書館（へ）行くとき、地図（を）持って行きます。" },
                    { q: "雨（　）降って（　）、サッカー（　）します。", a: "雨（が）降って（も）、サッカー（を）します。" },
                    { q: "お金（　）足りなかったら、銀行（　）下ろします。", a: "お金（が）足りなかったら、銀行（で/から）下ろします。" },
                    { q: "首相（　）来月、アメリカ（　）行く（　）ニュースで言っていました。", a: "首相（は）来月、アメリカ（へ）行く（と）ニュースで言っていました。" },
                    { q: "私（　）彼（　）空港（　）送ってあげました。", a: "私（は）彼（を）空港（まで/へ）送ってあげました。" }
                ]
                },
                part2: {
                title: "Part 2: จงผันรูปให้เหมาะสม",
                instruction: "เปลี่ยนคำในวงเล็บให้อยู่ในรูปที่ถูกต้อง (15 คะแนน)",
                type: "fill-in",
                questions: [
                    { q: "（行きます → _______ ）とき、「行ってまいります」と言います。", a: "出かける (Dict form) / 行く" },
                    { q: "あそこで（歌っています → _______ ）人は誰ですか。", a: "歌っている" },
                    { q: "これは母が（作りました → _______ ）ケーキです。", a: "作った" },
                    { q: "私は父に本を（読みます → _______ ）もらいました。", a: "読んで" },
                    { q: "もし 1億円（あります → _______ ）、世界旅行をしたいです。", a: "あったら" },
                    { q: "約束の時間に友達が（来ません → _______ ）、どうしますか。", a: "来なかったら" },
                    { q: "いくら（安いです → _______ ）、グループ旅行は嫌いです。", a: "安くても" },
                    { q: "日曜日、（暇です → _______ ）、遊びに来てください。", a: "暇だったら" },
                    { q: "使い方が（分かりません → _______ ）とき、私に聞いてください。", a: "分からない" },
                    { q: "図書館で（借ります → _______ ）本はこれです。", a: "借りる" },
                    { q: "私はミラーさんに漢字を（教えます → _______ ）あげました。", a: "教えて" },
                    { q: "太郎君は私に地図を（書きます → _______ ）くれました。", a: "書いて" },
                    { q: "エアコンを（つけます → _______ ）と、涼しくなります。", a: "つける" },
                    { q: "（眠いです → _______ ）ら、寝てもいいですよ。", a: "眠かった" },
                    { q: "明日、雨が（降ります → _______ ）と思います。", a: "降る" }
                ]
                },
                part3: {
                title: "Part 3: จงตอบคำถามให้เหมาะสม",
                instruction: "ตอบคำถามให้ถูกต้องตามหลักไวยากรณ์และบริบท (42 คะแนน)",
                type: "fill-in",
                questions: [
                    { q: "誰に日本語を教えてもらいましたか。", a: "日本人の先生に教えてもらいました。" },
                    { q: "財布を落としたとき、どうしますか。", a: "交番へ行きます。" },
                    { q: "暇なとき、いつも何をしますか。", a: "テレビを見たり、本を読んだりします。" },
                    { q: "この道をまっすぐ行くと、何がありますか。", a: "右に銀行があります。" },
                    { q: "明日、雨が降ったら、出かけますか。", a: "いいえ、出かけません。" },
                    { q: "日本の物価についてどう思いますか。", a: "高いと思います。" },
                    { q: "誰があなたの荷物を持ってくれましたか。", a: "ミラーさんが持ってくれました。" },
                    { q: "お金がたくさんあったら、何をしたいですか。", a: "新しいうちを買いたいです。" },
                    { q: "日曜日でも、働かなければなりませんか。", a: "はい、働かなければなりません。" },
                    { q: "眠い時、どうしますか。", a: "コーヒーを飲みます。" },
                    { q: "首相（นายกฯ）は来月、何をすると言いましたか。", a: "アメリカへ行くと言いました。" },
                    { q: "ミラーさんは来ないと思いますか。", a: "いいえ、きっと来ると思います。" },
                    { q: "その傘は誰のですか。", a: "佐藤さんに借りた傘です。" },
                    { q: "誰に本を貸してあげましたか。", a: "グプタさんに貸してあげました。" },
                    { q: "漢字の読み方が分からないとき、どうしますか。", a: "先生に聞きます。／辞書で調べます。" },
                    { q: "エアコンの調節（ปรับ）はどうやりますか。", a: "このボタンを押すと、温度が変わります。" },
                    { q: "転勤（ย้ายงาน）したいですか。", a: "いいえ、給料が高くても、転勤したくありません。" },
                    { q: "あの人は誰ですか。", a: "眼鏡をかけている人です。" },
                    { q: "誕生日に母に何をしてあげますか。", a: "料理を作ってあげます。" },
                    { q: "パスポートをなくしたことがありますか。", a: "いいえ、なくしたことがありません。" },
                    { q: "明日、暇だったら、何をしますか。", a: "映画を見に行きます。" }
                ]
                },
                part4: {
                title: "Part 4: แยกประโยคหลัก/ย่อย",
                instruction: "ระบุประโยคหลัก (Main) และส่วนขยาย (Sub/Modifier) (30 คะแนน)",
                type: "fill-in",
                questions: [
                    { q: "私は 朝ごはんを食べる 時間がありません。", a: "Main: 私は時間がありません。 / Sub: 朝ごはんを食べる。" },
                    { q: "京都へ行く人は ミラーさんです。", a: "Main: 人はミラーさんです。 / Sub: 京都へ行く。" },
                    { q: "昨日 買った 辞書は どこですか。", a: "Main: 辞書はどこですか。 / Sub: 昨日買った。" },
                    { q: "カリナさんが かいた 絵が 好きです。", a: "Main: 絵が好きです。 / Sub: カリナさんがかいた。" },
                    { q: "彼が 生まれた 所を 知っていますか。", a: "Main: 所を知っていますか。 / Sub: 彼が生まれた。" },
                    { q: "ミラーさんが 住んでいた うちは 古いです。", a: "Main: うちは古いです。 / Sub: ミラーさんが住んでいた。" },
                    { q: "彼女が 着ている 服は 新しいです。", a: "Main: 服は新しいです。 / Sub: 彼女が着ている。" },
                    { q: "友達と 映画を 見る 約束が あります。", a: "Main: 約束があります。 / Sub: 友達と映画を見る。" },
                    { q: "市役所へ 行く 用事が あります。", a: "Main: 用事があります。 / Sub: 市役所へ行く。" },
                    { q: "妻が 病気の とき、会社を 休みます。", a: "Main: 会社を休みます。 / Sub: 妻が病気の(とき)。" },
                    { q: "友達が 来る 前に、部屋を 掃除します。", a: "Main: 部屋を掃除します。 / Sub: 友達が来る(まえに)。" },
                    { q: "図書館で 借りた 本を 読みます。", a: "Main: 本を読みます。 / Sub: 図書館で借りた。" },
                    { q: "私が 欲しい 車は ドイツの 車です。", a: "Main: 車はドイツの車です。 / Sub: 私が欲しい。" },
                    { q: "日本語が 分からない 人は 英語で 話してください。", a: "Main: 人は英語で話してください。 / Sub: 日本語が分からない。" },
                    { q: "私は 母に 料理を 作ってあげました。", a: "Giver: 私 (ฉัน) / Receiver: 母 (แม่)" }
                ]
                },
                part5: {
                title: "Part 5: แก้ไขประโยค",
                instruction: "แก้ไขประโยคที่ผิดไวยากรณ์ให้ถูกต้อง (36 คะแนน)",
                type: "fill-in",
                questions: [
                    { q: "雨が降ると、出かけません。", a: "雨が降ったら、出かけません。" },
                    { q: "この本は山田さんが私に買ってあげました。", a: "山田さんは私にこの本を買ってくれました。" },
                    { q: "時間があったら、映画を見に行きますか。", a: "時間があったら、映画を見に行きませんか。" },
                    { q: "明日、天気がいいと、洗濯します。", a: "明日、天気がよかったら、洗濯します。" },
                    { q: "安いで、おいしいです。", a: "安くて、おいしいです。" },
                    { q: "私は花に水をくれました。", a: "あげました / やりました" },
                    { q: "パスポートをなくすとき、どうしますか。", a: "パスポートをなくしたとき、どうしますか。" },
                    { q: "約束の時間に友達が来ないたら、どうしますか。", a: "来なかったら" },
                    { q: "明日、雨が降ると思います。（ปฏิเสธ）", a: "明日、雨が降らないと思います。" },
                    { q: "彼は来ないと言いました。（อดีต）", a: "彼は「来ます」と言いました。/ 彼は来なかったと言いました。" },
                    { q: "元気でも、薬を飲まなければなりません。（แก้ไขเงื่อนไข）", a: "元気だったら、薬を飲まなくてもいいです。" },
                    { q: "いくら安かったら、買いません。", a: "いくら安くても、買いません。" },
                    { q: "ミラーさんは親切だと思います。", a: "親切だと思います。（Na-adj + だ）" },
                    { q: "日本へ行く前に、日本語を習いました。（แก้ให้ถูกถ้าโจทย์คือ 行った前に）", a: "日本へ行く前に" },
                    { q: "右へ曲がったら、銀行があります。", a: "右へ曲がると（ธรรมชาติกว่า）" },
                    { q: "私は佐藤さんに本を貸してくれました。", a: "私は佐藤さんに本を貸してあげました。" },
                    { q: "部屋はきれいだったら、借りたいです。", a: "部屋がきれいだったら" },
                    { q: "日曜日、テニスをして、映画を見ます。", a: "日曜日、テニスをしたり、映画を見たりします。" }
                ]
                },
                part6: {
                title: "Part 6: แปลประโยค",
                instruction: "แปลประโยคต่อไปนี้ (45 คะแนน)",
                type: "fill-in",
                questions: [
                    { q: "พรุ่งนี้ ถ้าฝนตก จะไม่ออกไปข้างนอก", a: "明日、雨が降ったら、出かけません。" },
                    { q: "คุณมิลเลอร์พูดว่า \"พรุ่งนี้จะไปโตเกียว\"", a: "ミラーさんは「明日、東京へ行きます」と言いました。" },
                    { q: "ถึงแม้ว่าจะง่วงนอน ก็ต้องทำการบ้าน", a: "眠くても、宿題をしなければなりません。" },
                    { q: "(ฉัน)ได้รับนาฬิกาเรือนนี้มาจากพี่สาว", a: "（私は）姉にこの時計をもらいました。" },
                    { q: "(ฉัน)ซื้อจักรยานให้ลูกชาย", a: "（私は）息子に自転車を買ってあげました。" },
                    { q: "คุณแม่ส่งพัสดุ(ของ)มาให้(ฉัน)", a: "母は（私に）荷物を送ってくれました。" },
                    { q: "คิดว่าราคาของที่ญี่ปุ่นแพง", a: "日本の物価は高いと思います。" },
                    { q: "ตอนที่เป็นเด็ก เคยว่ายน้ำที่แม่น้ำ", a: "子供のとき、川で泳いだことがあります。" },
                    { q: "ช่วยปิดหน้าต่างให้หน่อยได้ไหมครับ", a: "窓を閉めてくれませんか。／閉めてもらえませんか。" },
                    { q: "ถ้ากดปุ่มนี้ เงินทอนจะออกมา", a: "このボタンを押すと、お釣りが出ます。" },
                    { q: "คนที่ใส่แว่นตาอยู่คือคุณทานากะ", a: "眼鏡をかけている人は田中さんです。" },
                    { q: "นี่คือรูปถ่ายที่ถ่ายที่วัดทอง (Kinkakuji)", a: "これは金閣寺で撮った写真です。" },
                    { q: "明日、パーティーに行く？ (แปลไทย/ตอบรับ)", a: "พรุ่งนี้จะไปปาร์ตี้ไหม? / อืม ไป (うん、行く)" },
                    { q: "時間がなかったら、テレビを見ません。 (แปลไทย)", a: "ถ้าไม่มีเวลา จะไม่ดูทีวี" },
                    { q: "私は山田さんに図書館の電話番号を教えてもらいました。 (แปลไทย)", a: "ฉันให้คุณยามาดะบอกเบอร์โทรศัพท์ของห้องสมุดให้" }
                ]
                },
                part7: {
                title: "Part 7: เลือกคำตอบที่ถูกต้อง",
                instruction: "เลือกข้อที่ถูกต้องที่สุด (12 คะแนน)",
                type: "multiple-choice",
                questions: [
                    { q: "（　）雨が降ったら、行きません。", options: ["もし", "いくら", "たぶん", "ぜひ"], a: 0 },
                    { q: "彼は（　）来ると思います。（มั่นใจมาก）", options: ["たぶん", "きっと", "もし", "いくら"], a: 1 },
                    { q: "（　）高くても、買います。", options: ["もし", "たぶん", "いくら", "ぜひ"], a: 2 },
                    { q: "（　）来ないと思います。（อาจจะ/คาดคะเน）", options: ["もしかしたら", "きっと", "ぜひ", "いろいろ"], a: 0 },
                    { q: "道が（　）なりました。（ซับซ้อน）", options: ["複雑", "複雑に", "複雑な", "複雑く"], a: 1 },
                    { q: "（　）お祈りしましたか。（ครั้งหนึ่ง/สักครั้ง）", options: ["一度", "一度も", "一回も", "いつ"], a: 1 },
                    { q: "お湯が（　）。（ออกมา）", options: ["出します", "出ます", "おります", "おろします"], a: 1 },
                    { q: "音を（　）します。（ทำให้ดังขึ้น）", options: ["大きい", "大きく", "大きに", "大きくて"], a: 1 },
                    { q: "（　）遊びに来てください。（เชิญชวน）", options: ["きっと", "ぜひ", "たぶん", "もし"], a: 1 },
                    { q: "約束の時間に（　）、どうしますか。", options: ["間に合わなかったら", "間に合わないと", "間に合わなくて", "間に合う"], a: 0 },
                    { q: "図書館で本を（　）とき、カードが要ります。", options: ["借りた", "借りる", "借りて", "借ります"], a: 1 },
                    { q: "砂糖を（　）なくてもいいですよ。", options: ["入れ", "入ら", "入る", "入って"], a: 0 },
                ]
                }
            };

            const scrollToTop = () => {
                window.scrollTo({ top: 0, behavior: 'smooth' });
            };

            return (
                <div className="min-h-screen bg-gray-50 text-gray-800 font-sans pb-20">
                {/* Header */}
                <header className="bg-indigo-700 text-white p-4 shadow-lg sticky top-0 z-50">
                    <div className="max-w-4xl mx-auto flex justify-between items-center">
                    <div className="flex items-center gap-2">
                        <div className="w-6 h-6"><Icons.BookOpen /></div>
                        <h1 className="text-xl font-bold truncate">แบบฝึกหัดภาษาญี่ปุ่น (บทที่ 13-25)</h1>
                    </div>
                    <button 
                        onClick={() => setShowMenu(!showMenu)} 
                        className="p-2 md:hidden hover:bg-indigo-600 rounded"
                    >
                        {showMenu ? <div className="w-6 h-6"><Icons.X /></div> : <div className="w-6 h-6"><Icons.Menu /></div>}
                    </button>
                    
                    {/* Desktop Nav */}
                    <nav className="hidden md:flex gap-4 text-sm font-medium overflow-x-auto">
                        {Object.keys(examData).map(key => (
                        <button
                            key={key}
                            onClick={() => {
                            setActivePart(key);
                            window.scrollTo({ top: 0, behavior: 'smooth' });
                            }}
                            className={`px-3 py-1 rounded-full transition-colors whitespace-nowrap ${
                            activePart === key ? 'bg-white text-indigo-700' : 'hover:bg-indigo-600'
                            }`}
                        >
                            {key.replace('part', 'Part ')}
                        </button>
                        ))}
                    </nav>
                    </div>
                </header>

                {/* Mobile Menu */}
                {showMenu && (
                    <div className="fixed inset-0 z-40 bg-indigo-900/95 flex flex-col items-center justify-center p-6 md:hidden">
                    <button onClick={() => setShowMenu(false)} className="absolute top-4 right-4 text-white">
                        <div className="w-8 h-8"><Icons.X /></div>
                    </button>
                    <div className="flex flex-col gap-4 w-full max-w-xs">
                        {Object.entries(examData).map(([key, data]) => (
                        <button
                            key={key}
                            onClick={() => {
                            setActivePart(key);
                            setShowMenu(false);
                            window.scrollTo({ top: 0, behavior: 'smooth' });
                            }}
                            className={`p-4 rounded-lg text-lg font-bold text-center transition-all ${
                            activePart === key 
                                ? 'bg-white text-indigo-700 shadow-xl' 
                                : 'bg-indigo-800 text-white hover:bg-indigo-700'
                            }`}
                        >
                            {data.title.split(':')[0]}
                        </button>
                        ))}
                    </div>
                    </div>
                )}

                {/* Main Content */}
                <main className="max-w-4xl mx-auto p-4 md:p-8">
                    <div className="bg-white rounded-2xl shadow-sm border border-gray-100 p-6 mb-8">
                    <h2 className="text-2xl font-bold text-indigo-800 mb-2">{examData[activePart].title}</h2>
                    <p className="text-gray-500 mb-6 flex items-center gap-2">
                        <span className="w-2 h-2 rounded-full bg-indigo-500"></span>
                        {examData[activePart].instruction}
                    </p>

                    <div className="space-y-6">
                        {examData[activePart].questions.map((item, index) => (
                        <QuestionItem 
                            key={`${activePart}-${index}`} 
                            index={index} 
                            data={item} 
                            type={examData[activePart].type} 
                        />
                        ))}
                    </div>
                    </div>

                    {/* Navigation Buttons */}
                    <div className="flex justify-between mt-8">
                    <button
                        onClick={() => {
                        const keys = Object.keys(examData);
                        const prevIdx = keys.indexOf(activePart) - 1;
                        if (prevIdx >= 0) {
                            setActivePart(keys[prevIdx]);
                            window.scrollTo({ top: 0, behavior: 'smooth' });
                        }
                        }}
                        disabled={activePart === 'part1'}
                        className="px-6 py-3 rounded-lg bg-gray-200 text-gray-700 hover:bg-gray-300 disabled:opacity-50 disabled:cursor-not-allowed font-medium"
                    >
                        &larr; ก่อนหน้า
                    </button>

                    <button
                        onClick={() => {
                        const keys = Object.keys(examData);
                        const nextIdx = keys.indexOf(activePart) + 1;
                        if (nextIdx < keys.length) {
                            setActivePart(keys[nextIdx]);
                            window.scrollTo({ top: 0, behavior: 'smooth' });
                        }
                        }}
                        disabled={activePart === 'part7'}
                        className="px-6 py-3 rounded-lg bg-indigo-600 text-white hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed font-medium shadow-md hover:shadow-lg transition-all"
                    >
                        ถัดไป &rarr;
                    </button>
                    </div>
                </main>

                <button 
                    onClick={scrollToTop}
                    className="fixed bottom-6 right-6 p-3 bg-indigo-600 text-white rounded-full shadow-lg hover:bg-indigo-700 transition-all z-30 opacity-80 hover:opacity-100"
                >
                    <div className="w-6 h-6"><Icons.ArrowUp /></div>
                </button>
                </div>
            );
        };

        const QuestionItem = ({ index, data, type }) => {
            const [userAnswer, setUserAnswer] = useState('');
            const [showAnswer, setShowAnswer] = useState(false);
            const [selectedOption, setSelectedOption] = useState(null);

            if (type === 'fill-in') {
                return (
                <div className="p-4 rounded-xl border-l-4 border-indigo-200 bg-gray-50 hover:bg-white hover:shadow-md transition-all">
                    <div className="flex gap-3 mb-3">
                    <span className="font-bold text-indigo-600 min-w-[1.5rem]">{index + 1}.</span>
                    <p className="text-lg text-gray-800 leading-relaxed font-medium">{data.q}</p>
                    </div>
                    
                    <div className="ml-9 space-y-3">
                    <textarea
                        value={userAnswer}
                        onChange={(e) => setUserAnswer(e.target.value)}
                        placeholder="พิมพ์คำตอบของคุณที่นี่..."
                        className="w-full p-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-indigo-400 focus:border-indigo-400 outline-none transition-all resize-none bg-white"
                        rows={2}
                    />
                    
                    <button
                        onClick={() => setShowAnswer(!showAnswer)}
                        className={`flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-medium transition-all ${
                        showAnswer 
                            ? 'bg-amber-100 text-amber-700 hover:bg-amber-200' 
                            : 'bg-indigo-100 text-indigo-700 hover:bg-indigo-200'
                        }`}
                    >
                        {showAnswer ? <><div className="w-4 h-4"><Icons.EyeOff /></div> ซ่อนเฉลย</> : <><div className="w-4 h-4"><Icons.Eye /></div> ดูเฉลย</>}
                    </button>

                    {showAnswer && (
                        <div className="mt-2 p-4 bg-green-50 rounded-lg border border-green-200 animate-in fade-in slide-in-from-top-2 duration-300">
                        <p className="text-xs font-bold text-green-600 uppercase tracking-wide mb-1">เฉลย / Answer:</p>
                        <p className="text-green-800 font-medium text-lg">{data.a}</p>
                        </div>
                    )}
                    </div>
                </div>
                );
            }

            if (type === 'multiple-choice') {
                const isCorrect = selectedOption === data.a;
                const hasAnswered = selectedOption !== null;

                return (
                <div className="p-4 rounded-xl border-l-4 border-purple-200 bg-gray-50 hover:bg-white hover:shadow-md transition-all">
                    <div className="flex gap-3 mb-4">
                    <span className="font-bold text-purple-600 min-w-[1.5rem]">{index + 1}.</span>
                    <p className="text-lg text-gray-800 font-medium">{data.q}</p>
                    </div>

                    <div className="ml-9 grid grid-cols-1 sm:grid-cols-2 gap-3">
                    {data.options.map((opt, optIdx) => (
                        <button
                        key={optIdx}
                        onClick={() => setSelectedOption(optIdx)}
                        disabled={showAnswer}
                        className={`p-3 text-left rounded-lg border transition-all relative ${
                            selectedOption === optIdx
                            ? 'bg-indigo-50 border-indigo-400 ring-1 ring-indigo-400'
                            : 'bg-white border-gray-200 hover:border-indigo-300 hover:bg-indigo-50/30'
                        } ${showAnswer && optIdx === data.a ? '!bg-green-100 !border-green-500 !ring-2 !ring-green-500' : ''}
                            ${showAnswer && selectedOption === optIdx && selectedOption !== data.a ? '!bg-red-100 !border-red-400' : ''}
                        `}
                        >
                        <div className="flex items-center justify-between">
                            <span><span className="font-bold text-gray-400 mr-2">{String.fromCharCode(97 + optIdx)}.</span> {opt}</span>
                            {showAnswer && optIdx === data.a && <div className="w-5 h-5 text-green-600"><Icons.Check /></div>}
                            {showAnswer && selectedOption === optIdx && selectedOption !== data.a && <div className="w-5 h-5 text-red-500"><Icons.X /></div>}
                        </div>
                        </button>
                    ))}
                    </div>

                    <div className="ml-9 mt-4">
                    {!showAnswer ? (
                        <button
                        onClick={() => setShowAnswer(true)}
                        disabled={!hasAnswered}
                        className="flex items-center gap-2 px-5 py-2 rounded-lg bg-indigo-600 text-white font-medium shadow-sm hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed transition-all"
                        >
                        <div className="w-4 h-4"><Icons.Check /></div> ตรวจคำตอบ
                        </button>
                    ) : (
                        <div className={`p-3 rounded-lg border ${isCorrect ? 'bg-green-50 border-green-200 text-green-800' : 'bg-red-50 border-red-200 text-red-800'}`}>
                            <p className="font-bold">
                            {isCorrect ? 'ถูกต้อง! (Correct)' : 'ผิดครับ (Incorrect)'}
                            </p>
                            {!isCorrect && <p className="text-sm mt-1">คำตอบที่ถูกคือ: <span className="font-bold">{data.options[data.a]}</span></p>}
                        </div>
                    )}
                    </div>
                </div>
                );
            }
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<JapaneseExam />);
    </script>
</body>
</html>
